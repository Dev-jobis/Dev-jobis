<source>
  @type kafka
  brokers kafka1:9092,kafka2:9092,kafka3:9092
  topics chatbot-log
  format json
</source>
<source>
  @type kafka
  brokers kafka1:9092,kafka2:9092,kafka3:9092
  topics embedding-log
  format json
</source>
<match embedding-log>
  @type opensearch
  hosts "#{ENV['OPEN_URL']}"
  port 443
  user "#{ENV['OPENSEARCH_USER']}"
  password "#{ENV['OPENSEARCH_PASS']}"
  index_name embedding-log
  logstash_format false
</match>
<match chatbot-log>
  @type opensearch
  hosts "#{ENV['OPEN_URL']}"
  port 443
  user "#{ENV['OPENSEARCH_USER']}"
  password "#{ENV['OPENSEARCH_PASS']}"
  index_name chatbot-log
  logstash_format false
</match>

# 카프카 2서버 fluentd.conf
<source>
  @type kafka
  brokers kafka1:9092,kafka2:9092,kafka3:9092
  topics crawler-job-data
  format none
</source>
<match crawler-job-data>
  @type s3
  s3_bucket project05-crawling
  region ap-northeast-2
  path job-data/
  store_as text
  <buffer>
   timekey 60
  </buffer>
  <format>
    @type single_value
  </format>
</match>
<source>
  @type kafka
  brokers kafka1:9092,kafka2:9092,kafka3:9092
  topics crawler-log
  format json
</source>
<match crawler-log>
  @type opensearch
  hosts "#{ENV['OPEN_URL']}"
  port 443
  user "#{ENV['OPENSEARCH_USER']}"
  password "#{ENV['OPENSEARCH_PASS']}"
  index_name crawling-log
  logstash_format false
</match>